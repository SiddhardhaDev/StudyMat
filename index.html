<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Comprehensive Study Material</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700;800&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(135deg, #e0f2f7 0%, #c1e7f3 100%);
            color: #2d3748; /* Darker text for better contrast */
            line-height: 1.6;
        }
        .container {
            max-width: 1024px;
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 15px 30px -5px rgba(0, 0, 0, 0.15), 0 8px 15px -5px rgba(0, 0, 0, 0.08);
            margin-bottom: 2rem;
            border: 1px solid #e2e8f0;
        }
        h1 {
            font-family: 'Poppins', sans-serif;
            font-weight: 800;
            color: #2a69ac; /* Deeper blue */
            letter-spacing: -0.03em;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.08);
        }
        h2 {
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            color: #3182ce;
            letter-spacing: -0.02em;
            position: relative;
            padding-bottom: 0.75rem;
            margin-bottom: 2.5rem;
        }
        h2::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
            height: 2px;
            background-color: #bee3f8; /* Lighter blue line */
            border-radius: 1px;
        }
        
        /* --- List Styling --- */
        ol {
            list-style-type: none;
            padding-left: 0;
            margin-left: 0;
        }
        li {
            margin-bottom: 1.2rem;
            line-height: 1.6;
            display: flex;
            align-items: flex-start;
            background-color: #f7fafc;
            padding: 1rem;
            border-radius: 0.75rem;
            border: 1px solid #e2e8f0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        /* Custom number styling */
        li .list-number {
            font-weight: 600;
            color: #4c6a8b; /* Slightly darker number */
            margin-right: 0.75rem;
            min-width: 1.5rem;
            text-align: right;
            flex-shrink: 0;
            font-size: 1.1em;
        }
        li > div {
            flex-grow: 1;
        }

        /* Sub-points styling (i, ii, iii, etc.) */
        li ul {
            list-style-type: lower-roman;
            padding-left: 1.5rem;
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
            border-left: 2px solid #a0d1eb; /* Brighter border */
            padding-top: 0.5rem;
            padding-bottom: 0.5rem;
            background-color: #ebf8ff; /* Very light blue background */
            border-radius: 0.5rem;
            margin-top: 1rem;
        }
        li ul li {
            font-size: 0.95em;
            margin-bottom: 0.4rem;
            line-height: 1.5;
            border-bottom: none;
            padding-bottom: 0;
            display: list-item;
            background-color: transparent; /* Sub-list items transparent */
            box-shadow: none;
            border: none;
        }

        /* Specific styling for mathematical and chemical symbols */
        sup {
            vertical-align: super;
            font-size: 0.7em;
        }
        sub {
            vertical-align: sub;
            font-size: 0.7em;
        }
        footer {
            margin-top: 4rem;
            padding-top: 2rem;
            border-top: 1px solid #cbd5e0;
            color: #718096;
            font-size: 0.9rem;
            text-align: center;
        }

        /* Responsive adjustments */
        @media (max-width: 640px) {
            .container {
                padding: 1.5rem;
                border-radius: 1rem;
            }
            h1 {
                font-size: 2.5rem;
            }
            h2 {
                font-size: 2rem;
            }
            li {
                margin-bottom: 0.8rem;
                padding: 0.75rem;
            }
            ol {
                padding-left: 0.5rem;
            }
            li ul {
                padding-left: 1rem;
            }
        }

        /* --- Quiz Specific Styles --- */
        #quiz-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8); /* Darker overlay */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            backdrop-filter: blur(8px); /* Stronger blur */
            -webkit-backdrop-filter: blur(8px);
            overflow-y: auto;
        }

        .hidden {
            display: none !important;
        }

        #quiz-container {
            background-color: #ffffff;
            padding: 2.5rem;
            border-radius: 1.5rem;
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.4);
            max-width: 800px;
            width: 95%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: fadeInScale 0.3s ease-out forwards;
            border: 2px solid #63b3ed; /* Blue border for pop-up */
        }

        @keyframes fadeInScale {
            from {
                opacity: 0;
                transform: scale(0.9);
            }
            to {
                opacity: 1;
                transform: scale(1);
            }
        }

        .quiz-question {
            margin-bottom: 1.5rem;
            padding: 1.25rem;
            background-color: #e0f7fa; /* Light cyan */
            border-left: 5px solid #2bc7eb; /* Vibrant blue-green */
            border-radius: 0.75rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
        }

        .quiz-option {
            background-color: #f0faff; /* Lighter blue */
            padding: 0.85rem 1.25rem;
            border-radius: 0.75rem;
            margin-bottom: 0.75rem;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-out;
            border: 1px solid #d1ecf1;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }

        .quiz-option:hover {
            background-color: #cceeff; /* More vibrant hover */
            transform: translateY(-2px);
        }

        .quiz-option:active {
            transform: translateY(0);
        }

        .selected-option {
            background-color: #81d4fa !important; /* Brighter blue selection */
            border: 2px solid #2196f3;
            box-shadow: 0 3px 8px rgba(33, 150, 243, 0.3);
        }

        .correct-answer {
            background-color: #a7f3d0 !important; /* Soft green for correct */
            border: 2px solid #38a169;
            box-shadow: 0 3px 8px rgba(56, 161, 105, 0.3);
        }

        .wrong-answer {
            background-color: #ffcdd2 !important; /* Soft red for wrong */
            border: 2px solid #e53e3e;
            box-shadow: 0 3px 8px rgba(229, 62, 62, 0.3);
        }

        #close-quiz-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            font-size: 1.8rem; /* Larger close button */
            cursor: pointer;
            color: #6b7280;
            transition: color 0.2s, transform 0.1s;
        }
        #close-quiz-btn:hover {
            color: #e53e3e; /* Red on hover */
            transform: rotate(90deg);
        }

        #performance-chart,
        #subject-errors-chart {
            background-color: #fff;
            border-radius: 0.75rem;
            border: 1px solid #e2e8f0;
            width: 100%;
            height: 250px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.08);
        }
        #message-box {
            transform: translateX(calc(100% + 1rem));
        }

        /* Style for feedback message */
        #feedback-message {
            padding: 0.9rem;
            margin-top: 1.5rem;
            border-radius: 0.75rem;
            background-color: #f0f0f0; /* Neutral background by default */
            font-size: 1.05rem;
            font-weight: 500;
        }

        /* Custom Confirmation Dialog Styles */
        #confirm-box {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 2.5rem;
            border-radius: 1rem;
            box-shadow: 0 15px 30px rgba(0,0,0,0.3);
            z-index: 1001;
            text-align: center;
            max-width: 450px;
            width: 90%;
            border: 2px solid #f6ad55; /* Orange border for warning */
        }
        #confirm-box-text {
            font-size: 1.25rem;
            margin-bottom: 2rem;
            color: #333;
            font-weight: 600;
        }
        #confirm-box .flex button {
            padding: 0.9rem 1.8rem;
            border-radius: 0.6rem;
            font-weight: 700;
            cursor: pointer;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-out;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        #confirm-box .flex button:hover {
            transform: translateY(-2px);
        }
        #confirm-btn-yes {
            background-color: #ef4444; /* Stronger red */
            color: white;
        }
        #confirm-btn-yes:hover {
            background-color: #dc2626;
        }
        #confirm-btn-no {
            background-color: #e2e8f0; /* Lighter gray */
            color: #4a5568;
        }
        #confirm-btn-no:hover {
            background-color: #cbd5e0;
        }

        /* Buttons common style */
        .btn-primary {
            background-color: #4299e1; /* Blue */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.6rem;
            font-weight: 600;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-out;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .btn-primary:hover {
            background-color: #3182ce;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background-color: #a0aec0; /* Gray */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.6rem;
            font-weight: 600;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-out;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .btn-secondary:hover {
            background-color: #718096;
            transform: translateY(-2px);
        }

        .btn-success {
            background-color: #48bb78; /* Green */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.6rem;
            font-weight: 600;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-out;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .btn-success:hover {
            background-color: #38a169;
            transform: translateY(-2px);
        }

        .btn-danger {
            background-color: #ef4444; /* Red */
            color: white;
            padding: 0.75rem 1.5rem;
            border-radius: 0.6rem;
            font-weight: 600;
            transition: background-color 0.2s ease-in-out, transform 0.1s ease-out;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .btn-danger:hover {
            background-color: #dc2626;
            transform: translateY(-2px);
        }

        .table-header {
            background-color: #e2e8f0;
            color: #2d3748;
            font-weight: 700;
        }
    </style>
</head>
<body class="p-4 sm:p-8">
    <div class="container mx-auto">
        <h1 class="text-3xl sm:text-5xl text-center mb-10 pb-4">Comprehensive Study Material</h1>

        <section class="mb-16">
            <h2 class="text-2xl sm:text-4xl">Mathematics</h2>
            <ol>
                <li>
                    <span class="list-number">1.</span>
                    <div>
                        <b>Division Algorithm:</b> Given positive integers 'a' and 'b', there exists a unique pair of whole numbers 'q' and 'r' satisfying a = bq + r ; 0 &le; r which is less than b.
                    </div>
                </li>
                <li>
                    <span class="list-number">2.</span>
                    <div>
                        <b>The Fundamental Theorem of Arithmetic:</b> Every composite number can be expressed (factorized) as a product of its primes, and this factorization is unique, apart from the order in which the prime factors occurs.
                    </div>
                </li>
                <li>
                    <span class="list-number">3.</span>
                    <div>
                        If 'p' is a prime and 'p' divides a<sup>2</sup>, (where 'a' is a positive integer), then p divides a.
                    </div>
                </li>
                <li>
                    <span class="list-number">4.</span>
                    <div>
                        Let x be a rational number whose decimal expansion terminates. Then x can be expressed in the form of P/q, where p and q are coprime and the prime factorization of q is of the form 2<sup>n</sup>&nbsp;5<sup>m</sup>, where n and m are non-negative integers.
                    </div>
                </li>
                <li>
                    <span class="list-number">5.</span>
                    <div>
                        Let x = P/q be a rational number, such that the prime factorization of q is of the form 2<sup>n</sup>&nbsp;5<sup>m</sup>, where n and m are non-negative integers. Then x has a decimal expansion which terminates.
                    </div>
                </li>
                <li>
                    <span class="list-number">6.</span>
                    <div>
                        <b>Irrational number:</b> Let 'n' be any positive number which is not a perfect square then &radic;n is called an Irrational number.
                    </div>
                </li>
                <li>
                    <span class="list-number">7.</span>
                    <div>
                        An irrational number is neither terminating nor recurring decimal.
                    </div>
                </li>
                <li>
                    <span class="list-number">8.</span>
                    <div>
                        &pi; is an irrational number.
                    </div>
                </li>
                <li>
                    <span class="list-number">9.</span>
                    <div>
                        Let x = P/q be a rational number, such that the prime factorization of q is not of the form 2<sup>n</sup>&nbsp;5<sup>m</sup>, where n and m are non-negative integers. Then x has a decimal expansion which is non-terminating and repeating (recurring).
                    </div>
                </li>
                <li>
                    <span class="list-number">10.</span>
                    <div>
                        We define log<sub>a</sub>x = n, if a<sup>n</sup> = x, where a and x are positive numbers and a is &ne; 1, n is an element of Real numbers.
                    </div>
                </li>
                <li>
                    <span class="list-number">11.</span>
                    <div>
                        <b>Laws of logarithms:</b> If a, x and y are positive real numbers and a is &ne; 1, then log<sub>a</sub>(xy) = log<sub>a</sub>x + log<sub>a</sub>y.
                    </div>
                </li>
                <li>
                    <span class="list-number">12.</span>
                    <div>
                        log<sub>a</sub>(x/y) = log<sub>a</sub>x - log<sub>a</sub>y.
                    </div>
                </li>
                <li>
                    <span class="list-number">13.</span>
                    <div>
                        log<sub>a</sub>(x<sup>m</sup>) = m log<sub>a</sub>x.
                    </div>
                </li>
                <li>
                    <span class="list-number">14.</span>
                    <div>
                        a<sup>(log<sub>a</sub>N)</sup> = N.
                    </div>
                </li>
                <li>
                    <span class="list-number">15.</span>
                    <div>
                        log<sub>a</sub>1 = 0.
                    </div>
                </li>
                <li>
                    <span class="list-number">16.</span>
                    <div>
                        log<sub>a</sub>a = 1.
                    </div>
                </li>
                <li>
                    <span class="list-number">17.</span>
                    <div>
                        (log<sub>b</sub>(a<sup>m</sup>)) / (log<sub>b</sub>(a<sup>n</sup>)) = (m/n) log<sub>b</sub>a.
                    </div>
                </li>
                <li>
                    <span class="list-number">18.</span>
                    <div>
                        log<sub>y</sub>x = (log x) / (log y) (or) 1 / (log<sub>x</sub>y).
                    </div>
                </li>
                <li>
                    <span class="list-number">19.</span>
                    <div>
                        <b>The arithmetic mean of an ungrouped data:</b> Mean (x&#x0305;) = (Sum of all observations) / (No. of observations) = (&Sigma; x<sub>i</sub>) / n.
                    </div>
                </li>
                <li>
                    <span class="list-number">20.</span>
                    <div>
                        <b>Mode of ungrouped data:</b> If an observation occur more frequently in the data or an observation with the highest frequency is called the mode of the data. It is denoted by Z. Data having unique mode is called uni-modal data and the data having two modes is called bi-modal data.
                    </div>
                </li>
                <li>
                    <span class="list-number">21.</span>
                    <div>
                        <b>Median for ungrouped data:</b> The given data has to arrange in order of increasing or decreasing magnitude.
                        <ul>
                            <li>i) If the number of observations are 'n', and 'n' is odd then the median will be the ((n+1)/2)th observation of the data.</li>
                            <li>ii) If the number of observations are 'n', and 'n' is even then the median will be the average of (n/2)th and ((n/2)+1)th observations of the data.</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">22.</span>
                    <div>
                        <b>The mean for grouped data is calculated by:</b> The direct method: x&#x0305; = (&Sigma; f<sub>i</sub> x<sub>i</sub>) / (&Sigma; f<sub>i</sub>).
                    </div>
                </li>
                <li>
                    <span class="list-number">23.</span>
                    <div>
                        The assumed mean method: x&#x0305; = a + (&Sigma; f<sub>i</sub> d<sub>i</sub>) / (&Sigma; f<sub>i</sub>).
                    </div>
                </li>
                <li>
                    <span class="list-number">24.</span>
                    <div>
                        The step deviation method: x&#x0305; = a + (( &Sigma; f<sub>i</sub> u<sub>i</sub>) / (&Sigma; f<sub>i</sub>)) * h.
                    </div>
                </li>
                <li>
                    <span class="list-number">25.</span>
                    <div>
                        <b>The mode for grouped data</b> can be found by using the formula: Mode = l + ((f<sub>1</sub> - f<sub>0</sub>) / (2f<sub>1</sub> - f<sub>0</sub> - f<sub>2</sub>)) * h, where symbols have their usual meaning.
                    </div>
                </li>
                <li>
                    <span class="list-number">26.</span>
                    <div>
                        <b>The median for grouped data</b> is formed by using the formula: Median = l + (((n/2) - cf) / f) * h, where symbols have their usual meanings. Note: In order to find median, class intervals should be continuous.
                    </div>
                </li>
                <li>
                    <span class="list-number">27.</span>
                    <div>
                        While drawing less than ogives, upper boundaries are taken on X-axis and cumulative frequencies are taken on Y-axis.
                    </div>
                </li>
                <li>
                    <span class="list-number">28.</span>
                    <div>
                        While drawing greater than ogives, lower boundaries are taken on X-axis and cumulative frequencies are taken on Y-axis.
                    </div>
                </li>
                <li>
                    <span class="list-number">29.</span>
                    <div>
                        The median of grouped data can be obtained graphically as the x-coordinate of the point of intersection of the two ogives for this data.
                    </div>
                </li>
                <li>
                    <span class="list-number">30.</span>
                    <div>
                        <b>Empirical relation among Mean, Median and Mode is:</b> Mode = 3 Median - 2 Mean.
                    </div>
                </li>
            </ol>
        </section>

        <section class="mb-16">
            <h2 class="text-2xl sm:text-4xl">Physics</h2>
            <ol>
                <li>
                    <span class="list-number">1.</span>
                    <div>
                        **Image Formation by Reflection:**
                        <ul>
                            <li>i) The image formed by actual intersection of reflected rays is called real image. This can be caught on screen.</li>
                            <li>ii) The image formed by extended rays of reflection is called virtual image. It cannot be caught on screen.</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">2.</span>
                    <div>
                        **Sign Conventions for Curved Mirrors:** All distances should be measured from pole.
                        <ul>
                            <li>i) The distance measured in the direction of incident ray to be taken as positive and those measured in the direction opposite to incident ray to be taken as negative.</li>
                            <li>ii) Height of object (h<sub>o</sub>) and height of Image (h<sub>i</sub>) are positive if measured upwards from the principal axis and negative if measured downward.</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">3.</span>
                    <div>
                        For curved mirrors the radius of curvature will be twice the focal length, R = 2f.
                    </div>
                </li>
                <li>
                    <span class="list-number">4.</span>
                    <div>
                        **Concave mirror:** A spherical mirror, whose reflecting surface is curved inwards, that is, faces towards the centre of the sphere, is called a concave mirror. (A concave mirror can form a real or virtual image.)
                    </div>
                </li>
                <li>
                    <span class="list-number">5.</span>
                    <div>
                        **Convex mirror:** A spherical mirror, whose reflecting surface is curved outwards, is called a convex mirror. (A convex mirror always forms a virtual image for a real object.)
                    </div>
                </li>
                <li>
                    <span class="list-number">6.</span>
                    <div>
                        **Focal point:** The rays coming from the sun parallel to the principal axis of concave mirror after reflection converge at a point. This point is called Focus or focal point (F) of the concave mirror.
                    </div>
                </li>
                <li>
                    <span class="list-number">7.</span>
                    <div>
                        **Mirror Formulas:**
                        <ul>
                            <li>i) Mirror formula: (1/f) = (1/v) + (1/u).</li>
                            <li>ii) Magnification: m = (size of the image) / (size of the object) = (h<sub>i</sub>) / (h<sub>o</sub>) or m = (image distance) / (object distance) = (-v) / (u).</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">8.</span>
                    <div>
                        **Behavior of Light Rays on Mirrors:**
                        <ul>
                            <li>i) Any ray which passes parallel to the principal axis, after reflection passes through the focal point.</li>
                            <li>ii) The ray going through the focal point and falling on the mirror after reflection become parallel to principle axis.</li>
                            <li>iii) Any ray which passes through centre of curvature after reflection it retraces its path.</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">9.</span>
                    <div>
                        **Uses of spherical mirrors:**
                        <ul>
                            <li>i) Convex mirrors are used as rear view mirrors in automobiles.</li>
                            <li>ii) Convex mirrors are used in shopping malls and traffic junctions to observe traffic.</li>
                            <li>iii) Rear view mirror of vehicles is application of convex mirror where the field of view is large and also produces the erect and diminished image.</li>
                            <li>iv) Concave mirrors are used in torch lights and vehicle head lights.</li>
                            <li>v) Dentists are used to see larger images of the teeth of patients.</li>
                            <li>vi) Solar cooker is the application of concave mirror.</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">10.</span>
                    <div>
                        **Lens Types:**
                        <ul>
                            <li>i) A lens may have two spherical surfaces bulging outwards. Such lens is called Double convex lens (or) bi-convex lens.</li>
                            <li>ii) A double concave lens (or) biconcave lens is bounded by two spherical surfaces curved inward.</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">11.</span>
                    <div>
                        The distance between the focal point and pole is called focal length of lens denoted by 'f'.
                    </div>
                </li>
                <li>
                    <span class="list-number">12.</span>
                    <div>
                        **Behavior of Light Rays on Lenses:**
                        <ul>
                            <li>i) Any ray passing through the principal axis is undeviated.</li>
                            <li>ii) Any ray passing through at the optic centre is also undeviated.</li>
                            <li>iii) The rays passing parallel to the principal axis converge at focus or seems to diverge from the focus.</li>
                            <li>iv) The ray passing through focus will take a path parallel to principal axis after refraction.</li>
                            <li>v) When parallel rays fall on a lens making certain angle with principle axis, the rays converge at a point or appear to diverge from a point lying on a focal plane.</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">13.</span>
                    <div>
                        **Formulas for Lenses & Waves:**
                        <ul>
                            <li>i) The formula used when a light ray enters a medium with refractive index n<sub>2</sub> from a medium with refractive index n<sub>1</sub> at curved interface with a radius of curvature R is (n<sub>2</sub>/v) - (n<sub>1</sub>/u) = (n<sub>2</sub> - n<sub>1</sub>)/R.</li>
                            <li>ii) Lens formula is (1/f) = (1/v) - (1/u). Where, f is the focal length of lens, u is the object distance and v is the image distance.</li>
                            <li>iii) Lens maker's formula is (1/f) = (n-1) &times; ((1/R<sub>1</sub>) - (1/R<sub>2</sub>)). Where, R<sub>1</sub> and R<sub>2</sub> are radii of curvature of first and second curved surfaces, n is the refractive index and f is the focal length.</li>
                            <li>iv) The Relation between speed of wave (V), wave length (&lambda;) and frequency (&nu;) is V = &nu;&lambda;.</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">14.</span>
                    <div>
                        The convex lens behaves as a converging lens if it is kept in a medium with refractive index less than the refractive index of the lens and it behaves like a diverging lens when kept in a medium with refractive index greater than that of the lens.
                    </div>
                </li>
                <li>
                    <span class="list-number">15.</span>
                    <div>
                        The frequency of the light remains same while its wave length changes.
                    </div>
                </li>
            </ol>
        </section>

        <section class="mb-16">
            <h2 class="text-2xl sm:text-4xl">Chemistry</h2>
            <ol>
                <li>
                    <span class="list-number">1.</span>
                    <div>
                        A chemical equation is the symbolic representation of a Chemical Change or Chemical Reaction.
                    </div>
                </li>
                <li>
                    <span class="list-number">2.</span>
                    <div>
                        A balanced chemical equation explains about Reactants, Products and their Physical States during the reaction.
                    </div>
                </li>
                <li>
                    <span class="list-number">3.</span>
                    <div>
                        The chemical equation should always be balanced according to the Law of Conservation of Mass.
                    </div>
                </li>
                <li>
                    <span class="list-number">4.</span>
                    <div>
                        The chemical reaction in which heat is absorbed are called Endothermic Reactions and in which heat is evolved are Exothermic Reactions.
                    </div>
                </li>
                <li>
                    <span class="list-number">5.</span>
                    <div>
                        "Q" is heat energy which is shown with (+) plus sign on product side for exothermic reaction and (-) minus sign on product side for endothermic reactions.
                    </div>
                </li>
                <li>
                    <span class="list-number">6.</span>
                    <div>
                        A chemical equation containing simply symbols of elements and molecular formulae of the substance without balancing is known as Primary (or) skeleton equation.
                    </div>
                </li>
                <li>
                    <span class="list-number">7.</span>
                    <div>
                        The symbols of elements and formulae of the compounds should not be changed but only their coefficient should be altered while balancing the chemical equation.
                    </div>
                </li>
                <li>
                    <span class="list-number">8.</span>
                    <div>
                        Acid - base indicators are dye (or) mixtures of dyes which are used to detect the presence of acids & bases.
                    </div>
                </li>
                <li>
                    <span class="list-number">9.</span>
                    <div>
                        Acidic nature of a substance is due to the formation of H<sup>+</sup> ions in solution. Formation of OH<sup>-</sup> (aq) ions in solution is responsible for the basic nature of a substance.
                    </div>
                </li>
                <li>
                    <span class="list-number">10.</span>
                    <div>
                        The substances whose odour changes in acidic (or) basic medium are called olfactory indicators.
                    </div>
                </li>
                <li>
                    <span class="list-number">11.</span>
                    <div>
                        Onion, vanilla essence and clove oils are examples for olfactory indicators.
                    </div>
                </li>
                <li>
                    <span class="list-number">12.</span>
                    <div>
                        **Reactions of Acids and Bases with Metals:**
                        <ul>
                            <li>Eg: Acid + Metal &rarr; Salt + Hydrogen</li>
                            <li>Zn (s) + 2HCl (aq) &rarr; ZnCl<sub>2</sub> (aq) + H<sub>2</sub> (g) &uarr;</li>
                        </ul>
                        When a base reacts with metal gives corresponding salt and Hydrogen
                        <ul>
                            <li>Eg: Base + Metal &rarr; Salt + Hydrogen</li>
                            <li>2NaOH (aq) + Zn (s) &rarr; Na<sub>2</sub>ZnO<sub>2</sub> (aq) + H<sub>2</sub> (g) &uarr;</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">13.</span>
                    <div>
                        **Reactions with Carbonates and Bicarbonates:**
                        <ul>
                            <li>Eg : Metal Carbonate + Acid &rarr; Salt + Carbon dioxide + Water</li>
                            <li>Na<sub>2</sub>CO<sub>3</sub> + 2HCl &rarr; 2NaCl + CO<sub>2</sub> + H<sub>2</sub>O</li>
                        </ul>
                        Metal Hydrogen Carbonate + Acid &rarr; Salt + Carbon dioxide + Water
                        <ul>
                            <li>NaHCO<sub>3</sub> + HCl &rarr; NaCl + CO<sub>2</sub> + H<sub>2</sub>O</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">14.</span>
                    <div>
                        **Neutralization Reaction:**
                        <ul>
                            <li>Acid + Base &rarr; Salt + Water</li>
                            <li>HCl + NaOH &rarr; NaCl + H<sub>2</sub>O</li>
                        </ul>
                    </div>
                </li>
                <li>
                    <span class="list-number">15.</span>
                    <div>
                        Acidic and basic solutions in water conduct electricity because they produce Hydrogen ions (H<sup>+</sup>) and Hydroxy ions (OH<sup>-</sup>) respectively.
                    </div>
                </li>
            </ol>
        </section>

        <footer>
            Narayana Group of Schools &copy; 2025
        </footer>
    </div>

    <!-- Quiz Button -->
    <div class="fixed bottom-8 right-8 z-50">
        <button id="start-quiz-btn" class="btn-primary py-3 px-6 rounded-full shadow-lg">
            Start Quiz
        </button>
    </div>

    <!-- Quiz Overlay -->
    <div id="quiz-overlay" class="hidden fixed inset-0 bg-gray-900 bg-opacity-70 flex justify-center items-center p-4 z-[1000]">
        <div id="quiz-container" class="bg-white p-6 sm:p-10 rounded-xl shadow-2xl relative w-full max-w-3xl h-[90vh] overflow-y-auto">
            <button id="close-quiz-btn" class="absolute top-4 right-4">
                &times;
            </button>

            <!-- Initial Quiz Entry Section -->
            <div id="login-section" class="text-center p-8">
                <h3 class="text-2xl font-bold text-gray-800 mb-4">Welcome to the Quiz!</h3>
                <p class="text-gray-700 mb-6">Test your knowledge with our comprehensive quiz.</p>
                <div class="mt-8">
                    <button id="quiz-start-button" class="btn-success mr-4">
                        Start New Quiz
                    </button>
                    <button id="view-history-btn" class="btn-primary">
                        View Quiz History
                    </button>
                </div>
            </div>

            <!-- Main Quiz Content (questions, results, history) -->
            <div id="quiz-main-content" class="hidden">
                <!-- Quiz Questions Screen -->
                <div id="quiz-questions-screen" class="hidden">
                    <div id="quiz-questions">
                        <!-- Questions will be loaded here -->
                    </div>
                    <!-- Feedback message will appear here -->
                    <div id="feedback-message" class="mt-4 text-center font-semibold hidden"></div>
                    <div class="flex justify-between mt-6">
                        <button id="quiz-prev-btn" class="btn-secondary">
                            Previous
                        </button>
                        <button id="quiz-next-btn" class="btn-primary">
                            Next
                        </button>
                        <button id="quiz-submit-btn" class="hidden btn-success">
                            Submit Quiz
                        </button>
                    </div>
                </div>

                <!-- Quiz Results Screen -->
                <div id="quiz-results-screen" class="hidden text-center">
                    <h3 class="text-3xl font-bold text-gray-800 mb-4">Quiz Results</h3>
                    <p id="quiz-score" class="text-xl text-gray-700 mb-6"></p>
                    <button class="btn-primary mr-4">
                        Take Quiz Again
                    </button>
                    <button class="btn-secondary">
                        View History
                    </button>
                </div>

                <!-- Quiz History Screen -->
                <div id="quiz-history-screen" class="hidden">
                    <h3 class="text-3xl font-bold text-gray-800 mb-6 text-center">Quiz Performance History</h3>
                    <p id="no-history-message" class="text-lg text-gray-700 mb-4 text-center hidden">No quiz history available. Take a quiz to see your results here!</p>
                    <p id="performance-stats" class="text-lg text-gray-700 mb-4 text-center"></p>
                    
                    <div class="flex justify-center mb-6">
                        <canvas id="performance-chart" width="700" height="300" class="w-full max-w-md"></canvas>
                    </div>
                    
                    <h4 class="text-2xl font-bold text-gray-800 mb-4 mt-8">Errors by Subject:</h4>
                    <div class="flex justify-center mb-6">
                        <canvas id="subject-errors-chart" width="700" height="300" class="w-full max-w-md"></canvas>
                    </div>

                    <h4 class="text-2xl font-bold text-gray-800 mb-4 mt-8">Quiz Attempts (Current Session):</h4>
                    <div class="overflow-x-auto relative shadow-md sm:rounded-lg mb-6">
                        <table class="w-full text-sm text-left text-gray-500">
                            <thead class="text-xs uppercase table-header">
                                <tr>
                                    <th scope="col" class="py-3 px-6 rounded-tl-lg">Date</th>
                                    <th scope="col" class="py-3 px-6">Score</th>
                                    <th scope="col" class="py-3 px-6">Percentage</th>
                                    <th scope="col" class="py-3 px-6 rounded-tr-lg">Wrong Answers</th>
                                </tr>
                            </thead>
                            <tbody id="quiz-history-table-body">
                                <!-- Quiz history rows will be inserted here by loadQuizHistory() -->
                            </tbody>
                        </table>
                    </div>

                    <div id="wrong-answers-history-container" class="space-y-4 mb-6">
                        <!-- Detailed incorrect answers for selected quiz will be loaded here by toggleHistoryDetails() -->
                    </div>

                    <div class="flex justify-center gap-4 mt-6">
                        <button id="clear-history-btn" class="btn-danger">
                            Clear All History
                        </button>
                        <button class="btn-primary">
                            Back to Quiz Start
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Message Box -->
    <div id="message-box" class="fixed bottom-4 right-4 p-4 rounded-lg shadow-lg flex items-center transition-transform duration-300 ease-out z-50">
        <div id="message-box-icon" class="mr-2"></div>
        <span id="message-box-text"></span>
    </div>

    <!-- Custom Confirmation Dialog -->
    <div id="confirm-box" class="hidden">
        <p id="confirm-box-text" class="text-lg font-semibold mb-6"></p>
        <div class="flex justify-center gap-4">
            <button id="confirm-btn-yes" class="py-2 px-4 bg-red-500 text-white rounded-lg">Yes</button>
            <button id="confirm-btn-no" class="py-2 px-4 bg-gray-300 text-gray-800 rounded-lg">No</button>
        </div>
    </div>

    <script type="module">
        const questions = {
            math: [
                { q: "What is the remainder 'r' in the Division Algorithm a = bq + r ; 0 &le; r which is less than b?", options: ["r &lt; b", "r &gt; b", "r = b", "r &le; 0"], correct: "r &lt; b", point: "Mathematics Point 1", subject: "Mathematics" },
                { q: "According to the Fundamental Theorem of Arithmetic, how can every composite number be expressed?", options: ["As a sum of its primes", "As a product of its primes", "As a difference of its primes", "As a quotient of its primes"], correct: "As a product of its primes", point: "Mathematics Point 2", subject: "Mathematics" },
                { q: "If 'p' is a prime and 'p' divides a<sup>2</sup>, what else does 'p' divide?", options: ["a<sup>3</sup>", "2a", "a", "a+p"], correct: "a", point: "Mathematics Point 3", subject: "Mathematics" },
                { q: "A rational number x = P/q has a terminating decimal expansion if the prime factorization of q is of what form?", options: ["2<sup>n</sup>3<sup>m</sup>", "2<sup>n</sup>5<sup>m</sup>", "3<sup>n</sup>5<sup>m</sup>", "2<sup>n</sup>7<sup>m</sup>"], correct: "2<sup>n</sup>5<sup>m</sup>", point: "Mathematics Point 4", subject: "Mathematics" },
                { q: "What is the decimal expansion of an irrational number?", options: ["Terminating and repeating", "Non-terminating and repeating", "Terminating and non-repeating", "Non-terminating and non-repeating"], correct: "Non-terminating and non-repeating", point: "Mathematics Point 7", subject: "Mathematics" },
                { q: "Which of the following is an irrational number?", options: ["1/2", "0.333...", "&radic;4", "&pi;"], correct: "&pi;", point: "Mathematics Point 8", subject: "Mathematics" },
                { q: "What is log xy base a equal to?", options: ["log<sub>a</sub>x + log<sub>a</sub>y", "log<sub>a</sub>x + log<sub>a</sub>y", "log<sub>a</sub>x - log<sub>a</sub>y", "log<sub>a</sub>(x+y)"], correct: "log<sub>a</sub>x + log<sub>a</sub>y", point: "Mathematics Point 11", subject: "Mathematics" },
                { q: "What is the value of log 1 base a?", options: ["1", "a", "0", "undefined"], correct: "0", point: "Mathematics Point 15", subject: "Mathematics" },
                { q: "How is the mean of an ungrouped data calculated?", options: ["Product of observations / No. of observations", "Sum of observations * No. of observations", "Difference of observations / No. of observations", "Sum of observations / No. of observations"], correct: "Sum of observations / No. of observations", point: "Mathematics Point 19", subject: "Mathematics" },
                { q: "What is the Empirical relation among Mean, Median, and Mode?", options: ["Mode = Mean + Median", "Mode = 2 Median - 3 Mean", "Mode = Median - Mean", "Mode = 3 Median - 2 Mean"], correct: "Mode = 3 Median - 2 Mean", point: "Mathematics Point 30", subject: "Mathematics" },
                { q: "What is the value of log a base a?", options: ["0", "1", "a", "undefined"], correct: "1", point: "Mathematics Point 16", subject: "Mathematics" },
                { q: "If the number of observations 'n' is odd, what is the median for ungrouped data?", options: ["(n/2)th observation", "((n+1)/2)th observation", "(n-1)/2th observation", "n/2 + 1th observation"], correct: "((n+1)/2)th observation", point: "Mathematics Point 21 i)", subject: "Mathematics" },
                { q: "In the step deviation method for grouped data, what does 'h' represent?", options: ["Frequency", "Assumed mean", "Class size", "Cumulative frequency"], correct: "Class size", point: "Mathematics Point 24", subject: "Mathematics" },
                { q: "How is the direct method mean (x&#x0305;) for grouped data calculated?", options: ["(&Sigma;f<sub>i</sub>) / (&Sigma;f<sub>i</sub>x<sub>i</sub>)", "a + (&Sigma;f<sub>i</sub>d<sub>i</sub>) / (&Sigma;f<sub>i</sub>)", "(&Sigma;f<sub>i</sub>x<sub>i</sub>) / (&Sigma;f<sub>i</sub>)", "a + ((&Sigma;f<sub>i</sub>u<sub>i</sub>) / (&Sigma;f<sub>i</sub>)) * h"], correct: "(&Sigma;f<sub>i</sub>x<sub>i</sub>) / (&Sigma;f<sub>i</sub>)", point: "Mathematics Point 22", subject: "Mathematics" },
                { q: "What are taken on the X-axis when drawing less than ogives?", options: ["Lower boundaries", "Upper boundaries", "Frequencies", "Class marks"], correct: "Upper boundaries", point: "Mathematics Point 27", subject: "Mathematics" },
                { q: "What is the property of log (x/y) base a?", options: ["log<sub>a</sub>x + log<sub>a</sub>y", "log<sub>a</sub>x - log<sub>a</sub>y", "log<sub>a</sub>(x&times;y)", "log<sub>a</sub>(x<sup>y</sup>)"], correct: "log<sub>a</sub>x - log<sub>a</sub>y", point: "Mathematics Point 12", subject: "Mathematics" },
                { q: "What is log (x<sup>m</sup>) base a equivalent to?", options: ["log<sub>a</sub>x + m", "m log<sub>a</sub>x", "log<sub>a</sub>(x/m)", "log<sub>a</sub>x &times; log<sub>a</sub>m"], correct: "m log<sub>a</sub>x", point: "Mathematics Point 13", subject: "Mathematics" },
                { q: "What does 'a<sup>(log<sub>a</sub>N)</sup>' simplify to?", options: ["a", "N", "log<sub>a</sub>a", "1"], correct: "N", point: "Mathematics Point 14", subject: "Mathematics" },
                { q: "If 'n' is even, what is the median for ungrouped data?", options: ["((n+1)/2)th observation", "Average of (n/2)th and ((n/2)+1)th observations", "(n/2)th observation", "n-1th observation"], correct: "Average of (n/2)th and ((n/2)+1)th observations", point: "Mathematics Point 21 ii)", subject: "Mathematics" },
                { q: "For grouped data, what is 'l' in the mode formula?", options: ["Upper limit of modal class", "Lower limit of modal class", "Frequency of modal class", "Class size"], correct: "Lower limit of modal class", point: "Mathematics Point 25", subject: "Mathematics" },
                { q: "What type of decimal expansion does x = P/q have if the prime factorization of q is NOT of the form 2<sup>n</sup>5<sup>m</sup>?", options: ["Terminating", "Non-terminating and repeating", "Non-terminating and non-repeating", "None of the above"], correct: "Non-terminating and repeating", point: "Mathematics Point 9", subject: "Mathematics" },
                { q: "What does x&#x0305; (mean) denote in the assumed mean method?", options: ["Actual mean", "Assumed mean", "Deviation", "Frequency"], correct: "Actual mean", point: "Mathematics Point 23", subject: "Mathematics" },
                { q: "Which of the following is NOT a law of logarithms?", options: ["log<sub>a</sub>(xy) = log<sub>a</sub>x + log<sub>a</sub>y", "log<sub>a</sub>(x/y) = log<sub>a</sub>x - log<sub>a</sub>y", "log<sub>a</sub>(x+y) = log<sub>a</sub>x + log<sub>a</sub>y", "log<sub>a</sub>(x<sup>m</sup>) = m log<sub>a</sub>x"], correct: "log<sub>a</sub>(x+y) = log<sub>a</sub>x + log<sub>a</sub>y", point: "Mathematics Point 11", subject: "Mathematics" },
                { q: "What is 'f<sub>1</sub>' in the mode formula for grouped data?", options: ["Frequency of class preceding modal class", "Frequency of modal class", "Frequency of class succeeding modal class", "Cumulative frequency"], correct: "Frequency of modal class", point: "Mathematics Point 25", subject: "Mathematics" },
                { q: "What are taken on the X-axis when drawing greater than ogives?", options: ["Lower boundaries", "Upper boundaries", "Frequencies", "Class marks"], correct: "Lower boundaries", point: "Mathematics Point 28", subject: "Mathematics" },
                { q: "The median of grouped data can be obtained graphically as the x-coordinate of what point?", options: ["Intersection of X-axis and Y-axis", "Intersection of two ogives", "Midpoint of the histogram", "Peak of the frequency polygon"], correct: "Intersection of two ogives", point: "Mathematics Point 29", subject: "Mathematics" },
                { q: "In the median formula for grouped data, what does 'n' represent?", options: ["Number of classes", "Total number of observations", "Frequency of median class", "Class size"], correct: "Total number of observations", point: "Mathematics Point 26", subject: "Mathematics" },
                { q: "What is 'f' in the median formula for grouped data?", options: ["Frequency of class preceding median class", "Frequency of median class", "Frequency of class succeeding median class", "Cumulative frequency"], correct: "Frequency of median class", point: "Mathematics Point 26", subject: "Mathematics" },
                { q: "A data set having two modes is called what?", options: ["Uni-modal", "Bi-modal", "Multi-modal", "Amodal"], correct: "Bi-modal", point: "Mathematics Point 20", subject: "Mathematics" },
                { q: "What defines an irrational number?", options: ["A number that can be written as a fraction", "A number with a terminating decimal", "A positive number that is not a perfect square", "A number with a repeating decimal"], correct: "A positive number that is not a perfect square", point: "Mathematics Point 6", subject: "Mathematics" },
                { q: "What is the product of two consecutive positive integers and their HCF and LCM?", options: ["Product of integers", "Sum of integers", "HCF + LCM", "HCF / LCM"], correct: "Product of integers", point: "Mathematics Point 31", subject: "Mathematics" },
                { q: "Which type of polynomial has the highest power of the variable as 2?", options: ["Linear", "Cubic", "Quadratic", "Constant"], correct: "Quadratic", point: "Mathematics Point 32", subject: "Mathematics" },
                { q: "How many zeros does a cubic polynomial have?", options: ["At most one", "At most two", "At most three", "Exactly three"], correct: "At most three", point: "Mathematics Point 33", subject: "Mathematics" },
                { q: "What is the relationship between the sum of zeros ($\alpha + \beta$) and coefficients (a, b, c) of $ax^2 + bx + c$?", options: ["c/a", "-c/a", "b/a", "-b/a"], correct: "-b/a", point: "Mathematics Point 34", subject: "Mathematics" },
                { q: "For a linear equation $ax + by + c = 0$, what does the graph represent?", options: ["A curve", "A circle", "A straight line", "A parabola"], correct: "A straight line", point: "Mathematics Point 35", subject: "Mathematics" },
                { q: "If a pair of linear equations has infinitely many solutions, what is the condition?", options: ["$a_1/a_2 \ne b_1/b_2$", "$a_1/a_2 = b_1/b_2 \ne c_1/c_2$", "$a_1/a_2 = b_1/b_2 = c_1/c_2$", "$a_1b_2 - a_2b_1 = 0$"], correct: "$a_1/a_2 = b_1/b_2 = c_1/c_2$", point: "Mathematics Point 36", subject: "Mathematics" },
                { q: "What is the formula for the nth term of an AP with first term 'a' and common difference 'd'?", options: ["$a_n = a + nd$", "$a_n = a - (n-1)d$", "$a_n = a + (n-1)d$", "$a_n = a - nd$"], correct: "$a_n = a + (n-1)d$", point: "Mathematics Point 37", subject: "Mathematics" },
                { q: "What is the sum of the first 'n' terms of an AP?", options: ["$S_n = n/2 [a + (n-1)d]$", "$S_n = n/2 [2a + nd]$", "$S_n = n/2 [2a + (n-1)d]$", "$S_n = n [a + (n-1)d]$"], correct: "$S_n = n/2 [2a + (n-1)d]$", point: "Mathematics Point 38", subject: "Mathematics" },
                { q: "In a right-angled triangle, what is the relationship between the square of the hypotenuse and the squares of the other two sides?", options: ["Difference", "Sum", "Product", "Quotient"], correct: "Sum", point: "Mathematics Point 39", subject: "Mathematics" },
                { q: "What is the sum of the angles in any triangle?", options: ["$90^\circ$", "$270^\circ$", "$180^\circ$", "$360^\circ$"], correct: "$180^\circ$", point: "Mathematics Point 40", subject: "Mathematics" }
            ],
            physics: [
                { q: "An image formed by the actual intersection of reflected rays is called what?", options: ["Virtual image", "Real image", "Diminished image", "Enlarged image"], correct: "Real image", point: "Physics Point 1 i)", subject: "Physics" },
                { q: "When measuring distances for curved mirrors, from where should all distances be measured?", options: ["Focus", "Center of curvature", "Pole", "Optical center"], correct: "Pole", point: "Physics Point 2", subject: "Physics" },
                { q: "For curved mirrors, what is the relationship between the radius of curvature (R) and the focal length (f)?", options: ["R = f", "R = f/2", "R = 2f", "R = 4f"], correct: "R = 2f", point: "Physics Point 3", subject: "Physics" },
                { q: "Which type of mirror has its reflecting surface curved inwards?", options: ["Convex mirror", "Plane mirror", "Concave mirror", "Cylindrical mirror"], correct: "Concave mirror", point: "Physics Point 4", subject: "Physics" },
                { q: "Which type of mirror always forms a virtual image for a real object?", options: ["Concave mirror", "Plane mirror", "Convex mirror", "Parabolic mirror"], correct: "Convex mirror", point: "Physics Point 5", subject: "Physics" },
                { q: "What is the point called where rays parallel to the principal axis of a concave mirror converge after reflection?", options: ["Center of curvature", "Pole", "Optical center", "Focal point"], correct: "Focal point", point: "Physics Point 6", subject: "Physics" },
                { q: "In the lens formula, 1/f = 1/v - 1/u, what does 'u' represent?", options: ["Image distance", "Focal length", "Object distance", "Radius of curvature"], correct: "Object distance", point: "Physics Point 13 ii)", subject: "Physics" },
                { q: "According to lens maker's formula, what are R<sub>1</sub> and R<sub>2</sub>?", options: ["Radii of focus", "Radii of illumination", "Radii of curvature", "Radii of light"], correct: "Radii of curvature", point: "Physics Point 13 iii)", subject: "Physics" },
                { q: "What remains the same when light changes its wavelength in different media?", options: ["Speed", "Frequency", "Amplitude", "Intensity"], correct: "Frequency", point: "Physics Point 15", subject: "Physics" },
                { q: "Which type of mirror is used by dentists to see larger images of patients' teeth?", options: ["Convex mirror", "Plane mirror", "Concave mirror", "Cylindrical mirror"], correct: "Concave mirror", point: "Physics Point 9 v)", subject: "Physics" },
                { q: "What is a double convex lens also known as?", options: ["Biconcave lens", "Plano-concave lens", "Bi-convex lens", "Converging lens"], correct: "Bi-convex lens", point: "Physics Point 10 i)", subject: "Physics" },
                { q: "What is a double concave lens bounded by?", options: ["Two planar surfaces", "Two spherical surfaces curved outward", "Two spherical surfaces curved inward", "One planar and one curved surface"], correct: "Two spherical surfaces curved inward", point: "Physics Point 10 ii)", subject: "Physics" },
                { q: "What is the distance between the focal point and pole of a lens called?", options: ["Radius of curvature", "Optical axis", "Focal length", "Principal axis"], correct: "Focal length", point: "Physics Point 11", subject: "Physics" },
                { q: "Which ray passes undeviated through a lens?", options: ["Ray parallel to principal axis", "Ray passing through focal point", "Ray passing through optic centre", "Ray incident at pole"], correct: "Ray passing through optic centre", point: "Physics Point 12 ii)", subject: "Physics" },
                { q: "When does a convex lens behave as a diverging lens?", options: ["When kept in a medium with refractive index less than lens", "When kept in a medium with refractive index equal to lens", "When kept in a medium with refractive index greater than lens", "It always behaves as converging"], correct: "When kept in a medium with refractive index greater than lens", point: "Physics Point 14", subject: "Physics" },
                { q: "What type of image is formed by extended rays of reflection?", options: ["Real image", "Virtual image", "Inverted image", "Diminished image"], correct: "Virtual image", point: "Physics Point 1 ii)", subject: "Physics" },
                { q: "In sign conventions for curved mirrors, how are heights measured upwards from the principal axis considered?", options: ["Negative", "Zero", "Positive", "Irrelevant"], correct: "Positive", point: "Physics Point 2 ii)", subject: "Physics" },
                { q: "Which of these is a use of convex mirrors?", options: ["Torch lights", "Vehicle head lights", "Dentist mirrors", "Rear view mirrors in automobiles"], correct: "Rear view mirrors in automobiles", point: "Physics Point 9 i)", subject: "Physics" },
                { q: "A ray passing parallel to the principal axis of a mirror, after reflection, passes through what point?", options: ["Center of curvature", "Pole", "Focal point", "Optical center"], correct: "Focal point", point: "Physics Point 8 i)", subject: "Physics" },
                { q: "What does 'm' represent in the mirror magnification formula?", options: ["Mirror distance", "Object distance", "Size of the image / size of the object", "Focal length"], correct: "Size of the image / size of the object", point: "Physics Point 7 ii)", subject: "Physics" },
                { q: "What is the SI unit of electric current?", options: ["Volt", "Ohm", "Ampere", "Watt"], correct: "Ampere", point: "Physics Point 16", subject: "Physics" },
                { q: "What is Ohm's Law?", options: ["V = I/R", "R = V/I", "V = IR", "I = VR"], correct: "V = IR", point: "Physics Point 17", subject: "Physics" },
                { q: "What is the SI unit of electrical resistance?", options: ["Volt", "Ampere", "Ohm", "Joule"], correct: "Ohm", point: "Physics Point 18", subject: "Physics" },
                { q: "If resistors are connected in series, how is their total resistance calculated?", options: ["By summing their reciprocals", "By adding them directly", "By multiplying them", "By dividing them"], correct: "By adding them directly", point: "Physics Point 19", subject: "Physics" },
                { q: "If resistors are connected in parallel, how is their total resistance calculated?", options: ["By adding them directly", "By summing their reciprocals", "By multiplying them", "By dividing them"], correct: "By summing their reciprocals", point: "Physics Point 20", subject: "Physics" },
                { q: "What is the SI unit of power?", options: ["Joule", "Newton", "Watt", "Pascal"], correct: "Watt", point: "Physics Point 21", subject: "Physics" },
                { q: "What is the formula for electric power?", options: ["P = V/I", "P = I/V", "P = VI", "P = V + I"], correct: "P = VI", point: "Physics Point 22", subject: "Physics" },
                { q: "What is the SI unit of magnetic field strength?", options: ["Gauss", "Oersted", "Tesla", "Weber"], correct: "Tesla", point: "Physics Point 23", subject: "Physics" },
                { q: "Which rule is used to find the direction of the force on a current-carrying conductor in a magnetic field?", options: ["Right-Hand Thumb Rule", "Maxwell's Corkscrew Rule", "Fleming's Left-Hand Rule", "Fleming's Right-Hand Rule"], correct: "Fleming's Left-Hand Rule", point: "Physics Point 24", subject: "Physics" },
                { q: "What phenomenon is described by Faraday's Law of Electromagnetic Induction?", options: ["Light refraction", "Heat transfer", "Sound propagation", "Production of EMF by changing magnetic field"], correct: "Production of EMF by changing magnetic field", point: "Physics Point 25", subject: "Physics" },
                { q: "What is the SI unit of energy?", options: ["Watt", "Newton", "Joule", "Ampere"], correct: "Joule", point: "Physics Point 26", subject: "Physics" },
                { q: "What type of lens is used to correct myopia (nearsightedness)?", options: ["Convex lens", "Concave lens", "Cylindrical lens", "Plano-convex lens"], correct: "Concave lens", point: "Physics Point 27", subject: "Physics" },
                { q: "What type of lens is used to correct hypermetropia (farsightedness)?", options: ["Concave lens", "Convex lens", "Toric lens", "Bifocal lens"], correct: "Convex lens", point: "Physics Point 28", subject: "Physics" },
                { q: "What is the splitting of white light into its constituent colors called?", options: ["Reflection", "Refraction", "Dispersion", "Diffraction"], correct: "Dispersion", point: "Physics Point 29", subject: "Physics" },
                { q: "What is the unit of power of a lens?", options: ["Meter", "Centimeter", "Dioptre", "Watt"], correct: "Dioptre", point: "Physics Point 30", subject: "Physics" }
            ],
            chemistry: [
                { q: "What is a chemical equation?", options: ["Graphical representation", "Symbolic representation of chemical change", "Numerical representation", "Artistic representation"], correct: "Symbolic representation of chemical change", point: "Chemistry Point 1", subject: "Chemistry" },
                { q: "According to which law should a chemical equation always be balanced?", options: ["Law of Definite Proportions", "Law of Multiple Proportions", "Law of Conservation of Mass", "Law of Reciprocal Proportions"], correct: "Law of Conservation of Mass", point: "Chemistry Point 3", subject: "Chemistry" },
                { q: "What are reactions called in which heat is evolved?", options: ["Endothermic", "Exothermic", "Photosynthetic", "Catalytic"], correct: "Exothermic", point: "Chemistry Point 4", subject: "Chemistry" },
                { q: "A chemical equation without balancing is known as what?", options: ["Balanced equation", "Primary equation", "Net ionic equation", "Molecular equation"], correct: "Primary equation", point: "Chemistry Point 6", subject: "Chemistry" },
                { q: "What ions are responsible for the acidic nature of a substance in solution?", options: ["OH<sup>-</sup>", "H<sup>+</sup>", "Na<sup>+</sup>", "Cl<sup>-</sup>"], correct: "H<sup>+</sup>", point: "Chemistry Point 9", subject: "Chemistry" },
                { q: "What are substances called whose odor changes in acidic or basic medium?", options: ["pH indicators", "Olfactory indicators", "Litmus indicators", "Universal indicators"], correct: "Olfactory indicators", point: "Chemistry Point 10", subject: "Chemistry" },
                { q: "When an acid reacts with a metal, what are the products?", options: ["Salt + Oxygen", "Salt + Carbon dioxide", "Salt + Hydrogen", "Salt + Water"], correct: "Salt + Hydrogen", point: "Chemistry Point 12", subject: "Chemistry" },
                { q: "What are the products when a metal carbonate reacts with an acid?", options: ["Salt + Oxygen + Water", "Salt + Carbon dioxide + Water", "Salt + Hydrogen + Water", "Salt + Nitrogen + Water"], correct: "Salt + Carbon dioxide + Water", point: "Chemistry Point 13", subject: "Chemistry" },
                { q: "What are the products when an acid reacts with a base?", options: ["Salt + Oxygen", "Salt + Carbon dioxide", "Salt + Water", "Salt + Hydrogen"], correct: "Salt + Water", point: "Chemistry Point 14", subject: "Chemistry" },
                { q: "Why do acidic and basic solutions in water conduct electricity?", options: ["They are good conductors", "They produce ions", "They have high temperature", "They absorb light"], correct: "They produce ions", point: "Chemistry Point 15", subject: "Chemistry" },
                { q: "Which statement is true about balancing a chemical equation?", options: ["Only symbols of elements can be changed", "Only molecular formulae can be changed", "Only coefficients should be altered", "Both symbols and formulae can be changed"], correct: "Only coefficients should be altered", point: "Chemistry Point 7", subject: "Chemistry" },
                { q: "Which of the following is an example of an olfactory indicator?", options: ["Litmus paper", "Phenolphthalein", "Vanilla essence", "Methyl orange"], correct: "Vanilla essence", point: "Chemistry Point 11", subject: "Chemistry" },
                { q: "What is the common term for the reaction between an acid and a base forming salt and water?", options: ["Decomposition", "Combination", "Neutralization", "Displacement"], correct: "Neutralization", point: "Chemistry Point 14", subject: "Chemistry" },
                { q: "If heat is absorbed in a chemical reaction, what type of reaction is it?", options: ["Exothermic", "Endothermic", "Redox", "Combustion"], correct: "Endothermic", point: "Chemistry Point 4", subject: "Chemistry" },
                { q: "What ions are responsible for the basic nature of a substance in solution?", options: ["H<sup>+</sup>", "Cl<sup>-</sup>", "OH<sup>-</sup>", "Na<sup>+</sup>"], correct: "OH<sup>-</sup>", point: "Chemistry Point 9", subject: "Chemistry" },
                { q: "Where is 'Q' (heat energy) shown in an exothermic reaction?", options: ["On reactant side with minus sign", "On product side with minus sign", "On reactant side with plus sign", "On product side with plus sign"], correct: "On product side with plus sign", point: "Chemistry Point 5", subject: "Chemistry" },
                { q: "What is the purpose of acid-base indicators?", options: ["To speed up reactions", "To detect presence of acids & bases", "To produce heat", "To neutralize solutions"], correct: "To detect presence of acids & bases", point: "Chemistry Point 8", subject: "Chemistry" },
                { q: "What does a balanced chemical equation explain besides reactants and products?", options: ["Temperature of reaction", "Physical states of substances", "Time taken for reaction", "Color changes"], correct: "Physical states of substances", point: "Chemistry Point 2", subject: "Chemistry" },
                { q: "When a base reacts with a metal, what are the products?", options: ["Salt + Oxygen", "Salt + Hydrogen", "Salt + Water", "Salt + Carbon Dioxide"], correct: "Salt + Hydrogen", point: "Chemistry Point 12", subject: "Chemistry" },
                { q: "What are the products when a metal hydrogen carbonate reacts with an acid?", options: ["Salt + Water", "Salt + Carbon dioxide + Water", "Salt + Hydrogen + Water", "Salt + Oxygen"], correct: "Salt + Carbon dioxide + Water", point: "Chemistry Point 13", subject: "Chemistry" },
                 { q: "What is the general term for a substance that changes the rate of a chemical reaction without being consumed?", options: ["Inhibitor", "Catalyst", "Reactant", "Product"], correct: "Catalyst", point: "Chemistry Point 16", subject: "Chemistry" },
                { q: "What is the process of losing electrons in a chemical reaction called?", options: ["Reduction", "Oxidation", "Neutralization", "Hydrolysis"], correct: "Oxidation", point: "Chemistry Point 17", subject: "Chemistry" },
                { q: "What is the process of gaining electrons in a chemical reaction called?", options: ["Oxidation", "Reduction", "Combustion", "Decomposition"], correct: "Reduction", point: "Chemistry Point 18", subject: "Chemistry" },
                { q: "A reaction where a single compound breaks down into two or more simpler substances is called what?", options: ["Combination", "Displacement", "Double Displacement", "Decomposition"], correct: "Decomposition", point: "Chemistry Point 19", subject: "Chemistry" },
                { q: "What are the products of burning a hydrocarbon in sufficient oxygen?", options: ["Carbon monoxide and water", "Carbon dioxide and water", "Sulphur dioxide and water", "Nitrogen dioxide and water"], correct: "Carbon dioxide and water", point: "Chemistry Point 20", subject: "Chemistry" },
                { q: "Which gas is typically released when metals react with acids?", options: ["Oxygen", "Nitrogen", "Hydrogen", "Carbon dioxide"], correct: "Hydrogen", point: "Chemistry Point 21", subject: "Chemistry" },
                { q: "What is the pH of a neutral solution at 25 degrees Celsius?", options: ["0", "7", "14", "Between 0 and 7"], correct: "7", point: "Chemistry Point 22", subject: "Chemistry" },
                { q: "What is the chemical name for quicklime?", options: ["Calcium hydroxide", "Calcium carbonate", "Calcium oxide", "Calcium sulfate"], correct: "Calcium oxide", point: "Chemistry Point 23", subject: "Chemistry" },
                { q: "What is the chemical formula for baking soda?", options: ["$Na_2CO_3$", "$NaOH$", "$NaHCO_3$", "$NaCl$"], correct: "$NaHCO_3$", point: "Chemistry Point 24", subject: "Chemistry" },
                { q: "Which non-metal is a good conductor of electricity?", options: ["Sulfur", "Phosphorus", "Diamond", "Graphite"], correct: "Graphite", point: "Chemistry Point 25", subject: "Chemistry" },
                { q: "What type of bond is formed by the sharing of electrons between atoms?", options: ["Ionic bond", "Metallic bond", "Covalent bond", "Hydrogen bond"], correct: "Covalent bond", point: "Chemistry Point 26", subject: "Chemistry" },
                { q: "What type of bond is formed by the transfer of electrons between atoms?", options: ["Covalent bond", "Ionic bond", "Metallic bond", "Hydrogen bond"], correct: "Ionic bond", point: "Chemistry Point 27", subject: "Chemistry" },
                { q: "What is the smallest unit of an element that retains its chemical identity?", options: ["Molecule", "Compound", "Mixture", "Atom"], correct: "Atom", point: "Chemistry Point 28", subject: "Chemistry" },
                { q: "Which group in the periodic table contains the noble gases?", options: ["Group 1", "Group 17", "Group 18", "Group 16"], correct: "Group 18", point: "Chemistry Point 29", subject: "Chemistry" },
                { q: "What is the atomic number of an element?", options: ["Number of neutrons", "Number of electrons", "Number of protons", "Sum of protons and neutrons"], correct: "Number of protons", point: "Chemistry Point 30", subject: "Chemistry" }
            ]
        };

        let currentQuizQuestions = [];
        let currentQuestionIndex = 0;
        let userAnswers = {};
        let quizHistory = []; // Stores historical scores for the current session

        function initializeUI() {
            // No cookie loading on init, history starts fresh each session
            loadQuizHistory();
        }

        // Shuffle function (Fisher-Yates)
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]]; // Swap elements
            }
            return array;
        }

        function startQuiz() {
            // Select 10 random questions from the entire pool of each subject
            const selectedMathQuestions = shuffleArray([...questions.math]).slice(0, 10);
            const selectedPhysicsQuestions = shuffleArray([...questions.physics]).slice(0, 10);
            const selectedChemistryQuestions = shuffleArray([...questions.chemistry]).slice(0, 10);

            currentQuizQuestions = [
                ...selectedMathQuestions,
                ...selectedPhysicsQuestions,
                ...selectedChemistryQuestions
            ];

            currentQuestionIndex = 0;
            userAnswers = {};
            
            // Hide login/start screen and show quiz questions screen
            const loginSection = document.getElementById('login-section');
            const quizMainContent = document.getElementById('quiz-main-content');
            const quizQuestionsScreen = document.getElementById('quiz-questions-screen');
            const quizResultsScreen = document.getElementById('quiz-results-screen');
            const quizHistoryScreen = document.getElementById('quiz-history-screen');

            if (loginSection) loginSection.classList.add('hidden');
            if (quizMainContent) quizMainContent.classList.remove('hidden');
            if (quizQuestionsScreen) quizQuestionsScreen.classList.remove('hidden');
            if (quizResultsScreen) quizResultsScreen.classList.add('hidden');
            if (quizHistoryScreen) quizHistoryScreen.classList.add('hidden');

            displayQuestion();
            updateQuizProgress();
        }

        function displayQuestion() {
            const quizQuestionsContainer = document.getElementById('quiz-questions');
            if (!quizQuestionsContainer) return;

            quizQuestionsContainer.innerHTML = ''; // Clear previous question

            // Clear any previous feedback message
            const feedbackMessage = document.getElementById('feedback-message');
            if (feedbackMessage) {
                feedbackMessage.classList.add('hidden');
                feedbackMessage.textContent = '';
                feedbackMessage.classList.remove('text-green-600', 'text-red-600');
            }

            if (currentQuestionIndex >= currentQuizQuestions.length) {
                submitQuiz();
                return;
            }

            const questionData = currentQuizQuestions[currentQuestionIndex];
            const questionElement = document.createElement('div');
            questionElement.className = 'quiz-question';
            questionElement.innerHTML = `
                <p class="font-semibold text-lg mb-4">Question ${currentQuestionIndex + 1}/${currentQuizQuestions.length}: ${questionData.q}</p>
                <div id="options-container" class="space-y-3"></div>
            `;
            quizQuestionsContainer.appendChild(questionElement);

            const optionsContainer = document.getElementById('options-container');
            if (!optionsContainer) return;

            // Ensure options are clickable for new question
            optionsContainer.style.pointerEvents = 'auto';

            shuffleArray(questionData.options).forEach(option => {
                const optionElement = document.createElement('div');
                optionElement.className = 'quiz-option hover:bg-blue-100 transition-colors duration-200';
                optionElement.innerHTML = option;
                optionElement.addEventListener('click', function() {
                    selectOption(this, option);
                });
                optionsContainer.appendChild(optionElement);

                // Highlight selected option if already answered
                if (userAnswers[currentQuestionIndex] === option) {
                    optionElement.classList.add('selected-option');
                    optionElement.classList.add('bg-blue-200');
                }
            });

            updateQuizProgress();
        }

        function selectOption(selectedOptionElement, selectedOption) {
            const parentNode = selectedOptionElement.parentNode;
            if (!parentNode) return;

            // Remove selection from other options
            Array.from(parentNode.children).forEach(option => {
                option.classList.remove('selected-option', 'bg-blue-200');
            });
            // Add selection to the clicked option
            selectedOptionElement.classList.add('selected-option', 'bg-blue-200');
            userAnswers[currentQuestionIndex] = selectedOption;

            // Disable all options for the current question after a choice is made
            parentNode.style.pointerEvents = 'none';

            // Display feedback
            const feedbackMessage = document.getElementById('feedback-message');
            const questionData = currentQuizQuestions[currentQuestionIndex];

            // Highlight the correct answer in green
            Array.from(parentNode.children).forEach(option => {
                if (option.innerHTML === questionData.correct) {
                    option.classList.add('correct-answer');
                }
            });

            if (selectedOption === questionData.correct) {
                feedbackMessage.textContent = 'Correct! Good job!';
                feedbackMessage.classList.add('text-green-600');
                feedbackMessage.classList.remove('text-red-600');
            } else {
                selectedOptionElement.classList.add('wrong-answer');
                feedbackMessage.textContent = `Incorrect! The correct answer was: ${questionData.correct}`;
                feedbackMessage.classList.add('text-red-600');
                feedbackMessage.classList.remove('text-green-600');
            }
            feedbackMessage.classList.remove('hidden');
        }

        function nextQuestion() {
            if (userAnswers[currentQuestionIndex] === undefined) {
                showMessageBox("Please select an option before proceeding.");
                return;
            }
            currentQuestionIndex++;
            displayQuestion();
        }

        function prevQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                displayQuestion();
            }
        }

        function updateQuizProgress() {
            const prevBtn = document.getElementById('quiz-prev-btn');
            const nextBtn = document.getElementById('quiz-next-btn');
            const submitBtn = document.getElementById('quiz-submit-btn');

            if (prevBtn) {
                if (currentQuestionIndex === 0) {
                    prevBtn.classList.add('opacity-50', 'cursor-not-allowed');
                    prevBtn.disabled = true;
                } else {
                    prevBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                    prevBtn.disabled = false;
                }
            }

            if (nextBtn && submitBtn) {
                if (currentQuestionIndex === currentQuizQuestions.length - 1) {
                    nextBtn.classList.add('hidden');
                    submitBtn.classList.remove('hidden');
                } else {
                    nextBtn.classList.remove('hidden');
                    submitBtn.classList.add('hidden');
                }
            }
        }

        function submitQuiz() {
            if (userAnswers[currentQuestionIndex] === undefined) {
                showMessageBox("Please select an option for the current question before submitting.");
                return;
            }

            let correctCount = 0;
            const incorrectQuestionsDetails = [];
            currentQuizQuestions.forEach((qData, index) => {
                const userAnswer = userAnswers[index];
                if (userAnswer === qData.correct) {
                    correctCount++;
                } else {
                    incorrectQuestionsDetails.push({
                        question: qData.q,
                        userAnswer: userAnswer || "No answer selected",
                        correctAnswer: qData.correct,
                        relatedPoint: qData.point,
                        subject: qData.subject
                    });
                }
            });

            const score = correctCount;
            const totalQuestions = currentQuizQuestions.length;
            const percentage = (score / totalQuestions) * 100;

            const quizQuestionsScreen = document.getElementById('quiz-questions-screen');
            const quizResultsScreen = document.getElementById('quiz-results-screen');
            const quizScoreElement = document.getElementById('quiz-score');

            if (quizQuestionsScreen) quizQuestionsScreen.classList.add('hidden');
            if (quizResultsScreen) quizResultsScreen.classList.remove('hidden');
            if (quizScoreElement) quizScoreElement.innerHTML = `You scored: <span class="font-bold text-blue-600">${score}/${totalQuestions}</span> (${percentage.toFixed(2)}%)`;

            // Add results to in-memory history (no cookie saving)
            const newResult = {
                score: score,
                totalQuestions: totalQuestions,
                percentage: percentage,
                timestamp: new Date().toISOString(),
                incorrectQuestions: incorrectQuestionsDetails
            };
            quizHistory.push(newResult);

            showMessageBox("Quiz completed!", 'success');
            loadQuizHistory(); // Update history display
        }

        function loadQuizHistory() {
            // History is now strictly in-memory for the current session
            // No cookie retrieval
            
            // Sort history by timestamp (most recent first)
            quizHistory.sort((a, b) => {
                const timeA = a.timestamp ? new Date(a.timestamp).getTime() : 0;
                const timeB = b.timestamp ? new Date(b.timestamp).getTime() : 0;
                return timeB - timeA;
            });

            const quizHistoryTableBody = document.getElementById('quiz-history-table-body');
            const wrongAnswersHistoryContainer = document.getElementById('wrong-answers-history-container');
            const performanceStats = document.getElementById('performance-stats');
            const noHistoryMessage = document.getElementById('no-history-message');

            // Clear previous content
            if (quizHistoryTableBody) quizHistoryTableBody.innerHTML = '';
            if (wrongAnswersHistoryContainer) wrongAnswersHistoryContainer.innerHTML = '';
            if (performanceStats) performanceStats.textContent = '';
            if (noHistoryMessage) noHistoryMessage.classList.add('hidden');

            if (quizHistory.length === 0) {
                if (noHistoryMessage) noHistoryMessage.classList.remove('hidden');
            } else {
                if (noHistoryMessage) noHistoryMessage.classList.add('hidden');
                quizHistory.forEach((entry, index) => {
                    const row = document.createElement('tr');
                    row.className = 'border-b hover:bg-gray-100 cursor-pointer';
                    row.innerHTML = `
                        <td class="px-6 py-4 whitespace-nowrap">${new Date(entry.timestamp).toLocaleString()}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${entry.score} / ${entry.totalQuestions}</td>
                        <td class="px-6 py-4 whitespace-nowrap">${entry.percentage.toFixed(2)}%</td>
                        <td class="px-6 py-4 whitespace-nowrap">${entry.incorrectQuestions ? entry.incorrectQuestions.length : 0}</td>
                    `;
                    row.addEventListener('click', () => toggleHistoryDetails(index));
                    if (quizHistoryTableBody) quizHistoryTableBody.appendChild(row);
                });
            }

            const subjectErrorCounts = { "Mathematics": 0, "Physics": 0, "Chemistry": 0 };
            quizHistory.forEach(data => {
                if (data.incorrectQuestions) {
                    data.incorrectQuestions.forEach(item => {
                        if (item.subject && subjectErrorCounts[item.subject] !== undefined) {
                            subjectErrorCounts[item.subject]++;
                        }
                    });
                }
            });

            updatePerformanceGraph();
            drawSubjectErrorsChart(subjectErrorCounts);
        }

        function toggleHistoryDetails(index) {
            const wrongAnswersHistoryContainer = document.getElementById('wrong-answers-history-container');
            if (!wrongAnswersHistoryContainer) return;

            // Clear previous details
            wrongAnswersHistoryContainer.innerHTML = '';

            const selectedEntry = quizHistory[index];
            if (selectedEntry && selectedEntry.incorrectQuestions && selectedEntry.incorrectQuestions.length > 0) {
                const detailsHtml = document.createElement('div');
                detailsHtml.className = 'mt-4 p-4 bg-gray-100 rounded-md border border-gray-200';
                detailsHtml.innerHTML = `<h5 class="font-semibold text-lg mb-2 text-gray-800">Incorrect Answers for Quiz on ${new Date(selectedEntry.timestamp).toLocaleString()}:</h5>`;
                selectedEntry.incorrectQuestions.forEach(item => {
                    detailsHtml.innerHTML += `
                        <div class="bg-white p-3 rounded-md mb-2 border border-gray-200 shadow-sm">
                            <p class="text-sm"><strong>Q:</strong> ${item.question}</p>
                            <p class="text-sm text-red-600"><strong>Your Answer:</strong> ${item.userAnswer}</p>
                            <p class="text-sm text-green-600"><strong>Correct Answer:</strong> ${item.correctAnswer}</p>
                            <p class="text-xs text-gray-500 mt-1"><em>Related to: ${item.relatedPoint} (${item.subject})</em></p>
                        </div>
                    `;
                });
                wrongAnswersHistoryContainer.appendChild(detailsHtml);
            } else {
                wrongAnswersHistoryContainer.innerHTML = `<p class="mt-4 text-center text-gray-600">No incorrect answers for this quiz session.</p>`;
            }
        }

        function clearQuizHistory() {
            showConfirmationDialog("Are you sure you want to clear all quiz history for this session? This action cannot be undone.", () => {
                quizHistory = []; // Clear in-memory array
                loadQuizHistory(); // Refresh display
                showMessageBox("Quiz history cleared successfully for this session!", 'success');
            });
        }

        function updatePerformanceGraph() {
            const canvas = document.getElementById('performance-chart');
            if (!canvas) { return; }
            const ctx = canvas.getContext('2d');
            
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);
            ctx.clearRect(0, 0, rect.width, rect.height);

            if (quizHistory.length === 0) {
                const performanceStats = document.getElementById('performance-stats');
                if (performanceStats) performanceStats.textContent = 'No quiz history available.';
                ctx.clearRect(0, 0, canvas.width / dpr, canvas.height / dpr);
                return;
            }

            const totalMaxQuestionsForGraph = 30;
            const totalScores = quizHistory.reduce((sum, entry) => sum + entry.score, 0);
            const averageScore = totalScores / quizHistory.length;
            const performanceStats = document.getElementById('performance-stats');
            if (performanceStats) performanceStats.innerHTML = `Average Score: <span class="font-bold text-blue-600">${averageScore.toFixed(2)} / ${totalMaxQuestionsForGraph}</span>`;

            const scores = quizHistory.map(entry => entry.score);
            const maxScore = totalMaxQuestionsForGraph;
            const minScore = 0;
            const chartWidth = rect.width - 2 * 30;
            const chartHeight = rect.height - 2 * 30;
            const margin = 30;

            ctx.beginPath();
            ctx.strokeStyle = '#6b7280';
            ctx.lineWidth = 1;
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, rect.height - margin);
            ctx.moveTo(margin, rect.height - margin);
            ctx.lineTo(rect.width - margin, rect.height - margin);
            ctx.stroke();

            ctx.font = '12px Inter';
            ctx.fillStyle = '#6b7280';
            const numYLabels = 5;
            for (let i = 0; i <= numYLabels; i++) {
                const y = margin + chartHeight * (1 - i / numYLabels);
                const scoreLabel = Math.round(minScore + (maxScore - minScore) * (i / numYLabels));
                ctx.fillText(scoreLabel, margin - 25, y + 5);
            }
            ctx.fillText('Score', margin - 25, margin - 10);

            if (scores.length > 0) {
                const stepX = chartWidth / (scores.length > 1 ? scores.length - 1 : 1);
                for (let i = 0; i < scores.length; i++) {
                    const x = scores.length > 1 ? margin + (i / (scores.length - 1)) * chartWidth : margin;
                    ctx.fillText(`Q${i + 1}`, x - 5, rect.height - margin + 20);
                }
            } else if (scores.length === 1) {
                ctx.fillText(`Q1`, margin, rect.height - margin + 15);
            }

            ctx.beginPath();
            ctx.strokeStyle = '#3182ce';
            ctx.lineWidth = 2;
            for (let i = 0; i < scores.length; i++) {
                const x = scores.length > 1 ? margin + (i / (scores.length - 1)) * chartWidth : margin;
                const y = margin + chartHeight * (1 - (scores[i] - minScore) / (maxScore - minScore));
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
                ctx.arc(x, y, 4, 0, Math.PI * 2, false);
                ctx.fillStyle = '#3182ce';
                ctx.fill();
            }
            ctx.stroke();

            ctx.beginPath();
            ctx.strokeStyle = '#f56565';
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            const avgY = margin + chartHeight * (1 - (averageScore - minScore) / (maxScore - minScore));
            ctx.moveTo(margin, avgY);
            ctx.lineTo(rect.width - margin, avgY);
            ctx.stroke();
            ctx.setLineDash([]);

            ctx.fillStyle = '#f56565';
            ctx.fillText('Avg', rect.width - margin + 5, avgY + 5);
        }

        function drawSubjectErrorsChart(subjectErrorCounts) {
            const canvas = document.getElementById('subject-errors-chart');
            if (!canvas) { return; }
            const ctx = canvas.getContext('2d');

            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            ctx.scale(dpr, dpr);
            ctx.clearRect(0, 0, rect.width, rect.height);

            const subjects = Object.keys(subjectErrorCounts);
            const counts = Object.values(subjectErrorCounts);
            const maxCount = Math.max(...counts, 1);

            const chartWidth = rect.width - 2 * 30;
            const chartHeight = rect.height - 2 * 30;
            const margin = 30;
            const barWidth = (chartWidth / subjects.length) * 0.6;
            const barSpacing = chartWidth / subjects.length;

            ctx.beginPath();
            ctx.strokeStyle = '#6b7280';
            ctx.lineWidth = 1;
            ctx.moveTo(margin, margin);
            ctx.lineTo(margin, rect.height - margin);
            ctx.moveTo(margin, rect.height - margin);
            ctx.lineTo(rect.width - margin, rect.height - margin);
            ctx.stroke();

            ctx.font = '12px Inter';
            ctx.fillStyle = '#6b7280';
            const numYLabels = Math.min(maxCount, 5);
            for (let i = 0; i <= numYLabels; i++) {
                const y = margin + chartHeight * (1 - i / numYLabels);
                const label = Math.round(maxCount * (i / numYLabels));
                ctx.fillText(label, margin - 25, y + 5);
            }
            ctx.fillText('Errors', margin - 25, margin - 10);

            const colors = ['#60a5fa', '#34d399', '#f87171'];
            for (let i = 0; i < subjects.length; i++) {
                const x = margin + i * barSpacing + (barSpacing - barWidth) / 2;
                const barHeight = (counts[i] / maxCount) * chartHeight;
                const y = rect.height - margin - barHeight;

                ctx.fillStyle = colors[i % colors.length];
                ctx.fillRect(x, y, barWidth, barHeight);

                ctx.fillStyle = '#1a202c';
                ctx.textAlign = 'center';
                ctx.fillText(subjects[i], x + barWidth / 2, rect.height - margin + 20);
                if (counts[i] > 0) {
                    ctx.fillText(counts[i], x + barWidth / 2, y - 5);
                }
            }
        }

        function showMessageBox(message, type = 'info') {
            const msgBox = document.getElementById('message-box');
            const msgText = document.getElementById('message-box-text');
            const msgIcon = document.getElementById('message-box-icon');

            if (!msgBox || !msgText || !msgIcon) { return; }

            msgText.textContent = message;
            msgBox.className = 'fixed bottom-4 right-4 p-4 rounded-lg shadow-lg flex items-center transition-transform duration-300 ease-out z-50';

            msgBox.classList.remove('bg-green-100', 'border-green-400', 'text-green-700', 'bg-blue-100', 'border-blue-400', 'text-blue-700', 'bg-red-100', 'border-red-400', 'text-red-700');
            msgIcon.innerHTML = '';

            if (type === 'success') {
                msgBox.classList.add('bg-green-100', 'border-green-400', 'text-green-700');
                msgIcon.innerHTML = '<svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
            } else if (type === 'error') {
                msgBox.classList.add('bg-red-100', 'border-red-400', 'text-red-700');
                msgIcon.innerHTML = '<svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
            } else {
                msgBox.classList.add('bg-blue-100', 'border-blue-400', 'text-blue-700');
                msgIcon.innerHTML = '<svg class="w-6 h-6 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>';
            }
            
            msgBox.style.transform = 'translateX(0)';
            setTimeout(() => {
                msgBox.style.transform = 'translateX(calc(100% + 1rem))';
            }, 5000);
        }

        function showConfirmationDialog(message, onConfirm) {
            const confirmBox = document.getElementById('confirm-box');
            const confirmText = document.getElementById('confirm-box-text');
            const confirmBtnYes = document.getElementById('confirm-btn-yes');
            const confirmBtnNo = document.getElementById('confirm-btn-no');

            if (!confirmBox || !confirmText || !confirmBtnYes || !confirmBtnNo) {
                // Fallback to basic alert if dialog elements are missing.
                if (window.confirm(message)) {
                    onConfirm();
                }
                return;
            }

            confirmText.textContent = message;
            confirmBox.classList.remove('hidden');

            const handleYes = () => {
                confirmBox.classList.add('hidden');
                onConfirm();
                confirmBtnYes.removeEventListener('click', handleYes);
                confirmBtnNo.removeEventListener('click', handleNo);
            };

            const handleNo = () => {
                confirmBox.classList.add('hidden');
                confirmBtnYes.removeEventListener('click', handleYes);
                confirmBtnNo.removeEventListener('click', handleNo);
            };

            confirmBtnYes.addEventListener('click', handleYes);
            confirmBtnNo.addEventListener('click', handleNo);
        }

        document.addEventListener('DOMContentLoaded', () => {
            document.getElementById('start-quiz-btn').addEventListener('click', () => {
                document.getElementById('quiz-overlay').classList.remove('hidden');
                document.getElementById('login-section').classList.remove('hidden');
                document.getElementById('quiz-main-content').classList.add('hidden');
            });

            document.getElementById('close-quiz-btn').addEventListener('click', () => {
                document.getElementById('quiz-overlay').classList.add('hidden');
            });

            document.getElementById('quiz-start-button').addEventListener('click', startQuiz);
            document.getElementById('quiz-next-btn').addEventListener('click', nextQuestion);
            document.getElementById('quiz-prev-btn').addEventListener('click', prevQuestion);
            document.getElementById('quiz-submit-btn').addEventListener('click', submitQuiz);

            document.querySelector('#quiz-results-screen button:first-of-type').addEventListener('click', startQuiz);
            document.querySelector('#quiz-results-screen button:last-of-type').addEventListener('click', () => {
                document.getElementById('quiz-history-screen').classList.remove('hidden');
                document.getElementById('quiz-results-screen').classList.add('hidden');
                loadQuizHistory();
            });

            document.querySelector('#quiz-history-screen .flex button:last-of-type').addEventListener('click', () => {
                document.getElementById('login-section').classList.remove('hidden');
                document.getElementById('quiz-main-content').classList.add('hidden');
            });

            document.getElementById('view-history-btn').addEventListener('click', () => {
                document.getElementById('login-section').classList.add('hidden');
                document.getElementById('quiz-main-content').classList.remove('hidden');
                document.getElementById('quiz-history-screen').classList.remove('hidden');
                document.getElementById('quiz-questions-screen').classList.add('hidden');
                document.getElementById('quiz-results-screen').classList.add('hidden');
                loadQuizHistory();
            });

            document.getElementById('clear-history-btn').addEventListener('click', clearQuizHistory);

            window.addEventListener('resize', () => {
                if (!document.getElementById('quiz-history-screen').classList.contains('hidden')) {
                    loadQuizHistory();
                }
            });

            initializeUI();
        });
    </script>
</body>
</html>
